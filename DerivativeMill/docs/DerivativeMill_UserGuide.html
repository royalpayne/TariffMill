<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Derivative Mill - User Setup & Usage Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: white;
            padding: 40px 20px;
            text-align: center;
        }

        .header h1 {
            color: #42A0BD;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #aaa;
            font-size: 1.2em;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .toc {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .toc h2 {
            color: #42A0BD;
            margin-bottom: 15px;
            border-bottom: 2px solid #42A0BD;
            padding-bottom: 10px;
        }

        .toc ul {
            list-style: none;
        }

        .toc li {
            padding: 8px 0;
        }

        .toc a {
            color: #333;
            text-decoration: none;
            transition: color 0.2s;
        }

        .toc a:hover {
            color: #42A0BD;
        }

        .toc .sub-item {
            margin-left: 25px;
            font-size: 0.95em;
        }

        .section {
            background: white;
            border-radius: 10px;
            padding: 30px;
            margin: 25px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #42A0BD;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #42A0BD;
        }

        .section h3 {
            color: #333;
            font-size: 1.3em;
            margin: 25px 0 15px 0;
            padding-left: 15px;
            border-left: 4px solid #42A0BD;
        }

        .section h4 {
            color: #555;
            font-size: 1.1em;
            margin: 20px 0 10px 0;
        }

        .section p {
            margin: 10px 0;
            color: #555;
        }

        .section ul, .section ol {
            margin: 10px 0 10px 25px;
        }

        .section li {
            margin: 8px 0;
            color: #555;
        }

        .note {
            background: #e7f3ff;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .note-title {
            font-weight: bold;
            color: #007bff;
            margin-bottom: 5px;
        }

        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .warning-title {
            font-weight: bold;
            color: #856404;
            margin-bottom: 5px;
        }

        .tip {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        .tip-title {
            font-weight: bold;
            color: #155724;
            margin-bottom: 5px;
        }

        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Consolas', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 15px 0;
        }

        .step-box {
            display: flex;
            align-items: flex-start;
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .step-number {
            background: #42A0BD;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-content strong {
            color: #333;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        th {
            background: #42A0BD;
            color: white;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        .color-sample {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 4px;
            vertical-align: middle;
            margin-right: 8px;
            border: 1px solid #ccc;
        }

        .keyboard-shortcut {
            background: #e9ecef;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9em;
            border: 1px solid #ced4da;
        }

        .feature-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            border: 1px solid #e0e0e0;
        }

        .feature-card h4 {
            color: #42A0BD;
            margin-top: 0;
        }

        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #42A0BD;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            font-size: 1.5em;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            transition: background 0.2s;
        }

        .back-to-top:hover {
            background: #357a8f;
        }

        @media print {
            .back-to-top {
                display: none;
            }
            .section {
                break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Derivative Mill</h1>
        <p>User Setup & Usage Guide</p>
        <p style="font-size: 0.9em; margin-top: 10px;">Customs Documentation Processing System</p>
    </div>

    <div class="container">
        <!-- Table of Contents -->
        <div class="toc" id="top">
            <h2>Table of Contents</h2>
            <ul>
                <li><a href="#overview">1. Overview</a></li>
                <li><a href="#installation">2. Installation & Setup</a>
                    <ul class="sub-item">
                        <li><a href="#requirements">System Requirements</a></li>
                        <li><a href="#first-launch">First Launch Configuration</a></li>
                        <li><a href="#directory-setup">Directory Setup</a></li>
                    </ul>
                </li>
                <li><a href="#interface">3. User Interface Overview</a></li>
                <li><a href="#processing">4. Processing Invoices</a>
                    <ul class="sub-item">
                        <li><a href="#step-by-step">Step-by-Step Workflow</a></li>
                        <li><a href="#value-validation">Value Validation</a></li>
                        <li><a href="#editing-values">Editing Values</a></li>
                    </ul>
                </li>
                <li><a href="#configuration">5. Configuration</a>
                    <ul class="sub-item">
                        <li><a href="#invoice-mapping">Invoice Mapping Profiles</a></li>
                        <li><a href="#output-mapping">Output Mapping Profiles</a></li>
                        <li><a href="#parts-import">Parts Import</a></li>
                    </ul>
                </li>
                <li><a href="#references">6. References</a>
                    <ul class="sub-item">
                        <li><a href="#customs-config">Customs Config (Section 232 Tariffs)</a></li>
                        <li><a href="#sec232-actions">Section 232 Actions</a></li>
                    </ul>
                </li>
                <li><a href="#parts-view">7. Parts View</a></li>
                <li><a href="#settings">8. Application Settings</a></li>
                <li><a href="#troubleshooting">9. Troubleshooting</a></li>
                <li><a href="#keyboard">10. Keyboard Shortcuts</a></li>
            </ul>
        </div>

        <!-- Section 1: Overview -->
        <div class="section" id="overview">
            <h2>1. Overview</h2>
            <p>Derivative Mill is a professional desktop application designed for customs brokers and import specialists to streamline the processing of commercial invoices for U.S. Customs compliance. The application automates the complex task of matching parts data with HTS codes, calculating Section 232 tariff requirements, and generating properly formatted export worksheets.</p>

            <h3>Key Features</h3>
            <ul>
                <li><strong>Invoice Processing</strong> - Load CSV/Excel files and automatically match parts to HTS codes</li>
                <li><strong>Section 232 Compliance</strong> - Automatic calculation of Steel, Aluminum, Copper, Wood, and Automotive tariff ratios</li>
                <li><strong>Section 301 Exclusions</strong> - Track and highlight parts with active Section 301 exclusions</li>
                <li><strong>Parts Master Database</strong> - Maintain a comprehensive database of part numbers with HTS codes and material ratios</li>
                <li><strong>Flexible Mapping</strong> - Create and save mapping profiles for different client invoice formats</li>
                <li><strong>Export Customization</strong> - Configure output column names, visibility, and split by invoice options</li>
                <li><strong>Visual Indicators</strong> - Color-coded preview table showing material types and compliance status</li>
            </ul>

            <div class="note">
                <div class="note-title">Note</div>
                This application is designed for use by trained customs professionals. Understanding of HTS codes, Section 232 tariffs, and customs documentation requirements is assumed.
            </div>
        </div>

        <!-- Section 2: Installation & Setup -->
        <div class="section" id="installation">
            <h2>2. Installation & Setup</h2>

            <h3 id="requirements">System Requirements</h3>
            <ul>
                <li>Windows 10 or later (64-bit recommended)</li>
                <li>4 GB RAM minimum (8 GB recommended)</li>
                <li>100 MB free disk space</li>
                <li>Network access for shared database configurations (optional)</li>
            </ul>

            <h3 id="first-launch">First Launch Configuration</h3>
            <div class="step-box">
                <div class="step-number">1</div>
                <div class="step-content">
                    <strong>Run the Installer</strong><br>
                    Double-click the DerivativeMill installer and follow the prompts. The application will be installed to your Program Files directory.
                </div>
            </div>
            <div class="step-box">
                <div class="step-number">2</div>
                <div class="step-content">
                    <strong>Initialize Database</strong><br>
                    On first launch, the application will create a new SQLite database in the Resources folder. This database stores parts data, tariff tables, and configuration settings.
                </div>
            </div>
            <div class="step-box">
                <div class="step-number">3</div>
                <div class="step-content">
                    <strong>Configure Directories</strong><br>
                    Go to <strong>Settings > Settings</strong> and configure your Input and Output directories. These can be local folders or network paths.
                </div>
            </div>

            <h3 id="directory-setup">Directory Structure</h3>
            <table>
                <tr>
                    <th>Folder/File</th>
                    <th>Purpose</th>
                </tr>
                <tr>
                    <td><strong>DerivativeMill/</strong></td>
                    <td>Application root folder</td>
                </tr>
                <tr>
                    <td style="padding-left: 30px;">Input/</td>
                    <td>Place invoice files here for processing</td>
                </tr>
                <tr>
                    <td style="padding-left: 50px;">Processed/</td>
                    <td>Source files are moved here after export</td>
                </tr>
                <tr>
                    <td style="padding-left: 30px;">Output/</td>
                    <td>Exported Excel worksheets are saved here</td>
                </tr>
                <tr>
                    <td style="padding-left: 50px;">Processed/</td>
                    <td>Archived export files</td>
                </tr>
                <tr>
                    <td style="padding-left: 30px;">Resources/</td>
                    <td>Database and reference files</td>
                </tr>
                <tr>
                    <td style="padding-left: 50px;">derivativemill.db</td>
                    <td>SQLite database (parts, tariffs, profiles)</td>
                </tr>
                <tr>
                    <td style="padding-left: 50px;">HTS_qty1.xlsx</td>
                    <td>Optional HTS units reference file</td>
                </tr>
                <tr>
                    <td style="padding-left: 30px;">config.ini</td>
                    <td>Shared configuration (database path)</td>
                </tr>
            </table>

            <div class="tip">
                <div class="tip-title">Tip: Shared Database</div>
                For multi-user environments, you can configure a shared database location on a network drive. Go to <strong>Settings > Settings</strong> and set the Database Path to a network location accessible by all users.
            </div>
        </div>

        <!-- Section 3: User Interface -->
        <div class="section" id="interface">
            <h2>3. User Interface Overview</h2>

            <h3>Main Window Layout</h3>
            <p>The application uses a tabbed interface with the following primary tabs:</p>

            <table>
                <tr>
                    <th>Tab</th>
                    <th>Purpose</th>
                </tr>
                <tr>
                    <td><strong>Process Shipment</strong></td>
                    <td>Main workflow tab for loading and processing invoice files</td>
                </tr>
                <tr>
                    <td><strong>Parts View</strong></td>
                    <td>Browse and edit the parts master database</td>
                </tr>
            </table>

            <h3>Menu Bar</h3>
            <table>
                <tr>
                    <th>Menu</th>
                    <th>Contents</th>
                </tr>
                <tr>
                    <td><strong>Settings</strong></td>
                    <td>Application settings (directories, theme, font size, colors)</td>
                </tr>
                <tr>
                    <td><strong>Log View</strong></td>
                    <td>View application log for debugging</td>
                </tr>
                <tr>
                    <td><strong>References</strong></td>
                    <td>Customs Config (Section 232 tariffs) and Section 232 Actions tables</td>
                </tr>
                <tr>
                    <td><strong>Configuration</strong></td>
                    <td>Invoice Mapping, Output Mapping, and Parts Import tools</td>
                </tr>
                <tr>
                    <td><strong>Help</strong></td>
                    <td>Check for Updates and About information</td>
                </tr>
            </table>

            <h3>Process Shipment Tab Layout</h3>
            <p>The Process Shipment tab is divided into two main areas:</p>

            <div class="feature-card">
                <h4>Left Panel - Controls</h4>
                <ul>
                    <li><strong>Shipment File</strong> - Map Profile selector and Input Files list</li>
                    <li><strong>Invoice Values</strong> - CI Value, Net Weight, MID selection, and Invoice Check status</li>
                    <li><strong>Actions</strong> - Process Invoice and Clear All buttons</li>
                    <li><strong>Export Profile</strong> - Quick access to output mapping profiles</li>
                    <li><strong>Exported Files</strong> - List of recently exported files with invoice total display</li>
                </ul>
            </div>

            <div class="feature-card">
                <h4>Right Panel - Result Preview</h4>
                <p>A data table showing processed invoice data with the following columns:</p>
                <ul>
                    <li>Product No, Value, HTS, MID, CBP_qty1</li>
                    <li>Dec (Declaration Code), Melt, Cast, Smelt, Flag</li>
                    <li>Steel%, Al%, Cu%, Wood%, Auto%, Non-232%</li>
                    <li>232 Status</li>
                </ul>
            </div>
        </div>

        <!-- Section 4: Processing Invoices -->
        <div class="section" id="processing">
            <h2>4. Processing Invoices</h2>

            <h3 id="step-by-step">Step-by-Step Workflow</h3>

            <div class="step-box">
                <div class="step-number">1</div>
                <div class="step-content">
                    <strong>Select a Map Profile</strong><br>
                    Choose the appropriate mapping profile from the "Map Profile" dropdown. Each profile defines how columns in the input file map to the required fields (part number, value, quantity, etc.).
                </div>
            </div>

            <div class="step-box">
                <div class="step-number">2</div>
                <div class="step-content">
                    <strong>Select an Input File</strong><br>
                    Click on a file in the "Input Files" list. The file will be loaded and parsed according to the selected mapping profile. The "Selected File" label will show the chosen file.
                </div>
            </div>

            <div class="step-box">
                <div class="step-number">3</div>
                <div class="step-content">
                    <strong>Enter Invoice Values</strong><br>
                    <ul>
                        <li><strong>CI Value (USD)</strong> - Enter the Commercial Invoice total value</li>
                        <li><strong>Net Weight (kg)</strong> - Enter the total net weight in kilograms</li>
                        <li><strong>MID</strong> - Select or verify the Manufacturer ID from the dropdown</li>
                    </ul>
                </div>
            </div>

            <div class="step-box">
                <div class="step-number">4</div>
                <div class="step-content">
                    <strong>Click "Process Invoice"</strong><br>
                    The application will:
                    <ul>
                        <li>Parse all line items from the invoice</li>
                        <li>Look up each part number in the Parts Master database</li>
                        <li>Match HTS codes and retrieve Section 232 tariff information</li>
                        <li>Calculate material ratios and declaration requirements</li>
                        <li>Display results in the Preview table</li>
                    </ul>
                </div>
            </div>

            <div class="step-box">
                <div class="step-number">5</div>
                <div class="step-content">
                    <strong>Verify Invoice Check</strong><br>
                    The "Invoice Check" indicator shows whether the calculated total matches your entered CI Value:
                    <ul>
                        <li><span style="color: green; font-weight: bold;">Green</span> - Values match, ready to export</li>
                        <li><span style="color: red; font-weight: bold;">Red</span> - Values don't match, review needed</li>
                    </ul>
                </div>
            </div>

            <div class="step-box">
                <div class="step-number">6</div>
                <div class="step-content">
                    <strong>Export Worksheet</strong><br>
                    When values match, the button changes to "Export Worksheet". Click to generate the Excel file. The source file is automatically moved to the Processed folder.
                </div>
            </div>

            <h3 id="value-validation">Value Validation</h3>
            <p>The application performs automatic value validation to ensure data integrity:</p>
            <ul>
                <li>The sum of all line item values is compared against the CI Value you entered</li>
                <li>A tolerance of $0.01 is allowed for rounding differences</li>
                <li>If values don't match, you must either correct the CI Value or edit individual line items</li>
            </ul>

            <h3 id="editing-values">Editing Values</h3>
            <p>If the invoice total doesn't match, click the "Edit Values" button to enter edit mode:</p>
            <ul>
                <li>Double-click any cell in the preview table to edit its value</li>
                <li>Right-click a row for additional options (add row, delete row)</li>
                <li>The running total updates in real-time as you make changes</li>
                <li>When values match, click "Save & Process" to proceed to export</li>
            </ul>

            <div class="warning">
                <div class="warning-title">Important</div>
                Edited values are used for the current export only. To permanently update part information, use the Parts View tab or Parts Import feature in Configuration.
            </div>
        </div>

        <!-- Section 5: Configuration -->
        <div class="section" id="configuration">
            <h2>5. Configuration</h2>
            <p>Access configuration tools via the <strong>Configuration</strong> menu.</p>

            <h3 id="invoice-mapping">Invoice Mapping Profiles</h3>
            <p>Invoice Mapping profiles define how columns in your input files map to the required data fields. Different clients often have different invoice formats, so you can create and save profiles for each.</p>

            <h4>Creating a New Profile</h4>
            <ol>
                <li>Go to <strong>Configuration > Configuration...</strong></li>
                <li>Select the <strong>Invoice Mapping</strong> tab</li>
                <li>Click <strong>Load File</strong> to select a sample invoice file</li>
                <li>Drag column headers from the source file to the target field boxes</li>
                <li>Set the <strong>Header Row</strong> if headers aren't on row 1</li>
                <li>Click <strong>Save Profile</strong> and enter a profile name</li>
            </ol>

            <h4>Required Fields</h4>
            <table>
                <tr>
                    <th>Field</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>Part Number</td>
                    <td>Product/part identifier (required)</td>
                </tr>
                <tr>
                    <td>Value</td>
                    <td>Line item value in USD (required)</td>
                </tr>
                <tr>
                    <td>Quantity</td>
                    <td>Number of units</td>
                </tr>
                <tr>
                    <td>Net Weight</td>
                    <td>Weight in kilograms</td>
                </tr>
                <tr>
                    <td>HTS Code</td>
                    <td>Harmonized Tariff Schedule code</td>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Product description</td>
                </tr>
                <tr>
                    <td>Invoice Number</td>
                    <td>For split-by-invoice exports</td>
                </tr>
            </table>

            <h3 id="output-mapping">Output Mapping Profiles</h3>
            <p>Output Mapping profiles control how the export file is formatted.</p>

            <h4>Options</h4>
            <ul>
                <li><strong>Column Names</strong> - Customize the header names in the export file</li>
                <li><strong>Column Visibility</strong> - Toggle which columns appear in the export</li>
                <li><strong>Split by Invoice</strong> - Create separate files for each invoice number</li>
            </ul>

            <div class="tip">
                <div class="tip-title">Quick Access</div>
                Use the "Export Profile" dropdown on the Process Shipment tab to quickly switch between output profiles without opening the Configuration dialog.
            </div>

            <h3 id="parts-import">Parts Import</h3>
            <p>The Parts Import feature allows you to bulk-import or update parts data from CSV/Excel files.</p>

            <h4>Import Process</h4>
            <ol>
                <li>Go to <strong>Configuration > Configuration...</strong></li>
                <li>Select the <strong>Parts Import</strong> tab</li>
                <li>Drag and drop a file or click to browse</li>
                <li>Map the source columns to the Parts Master fields</li>
                <li>Click <strong>Import</strong> to add/update parts</li>
            </ol>

            <h4>Importable Fields</h4>
            <ul>
                <li>Part Number, Description, HTS Code</li>
                <li>Country of Origin, MID, Client Code</li>
                <li>Steel Ratio, Aluminum Ratio, Copper Ratio, Wood Ratio, Auto Ratio</li>
                <li>Country of Melt, Cast, Smelt</li>
                <li>Section 301 Exclusion Tariff</li>
            </ul>

            <h4>Section 301 Import</h4>
            <p>Use the "Import Sec301 CSV" button to import Section 301 exclusion tariffs. The CSV should have columns for Part Number and Sec301 Exclusion Tariff code.</p>
        </div>

        <!-- Section 6: References -->
        <div class="section" id="references">
            <h2>6. References</h2>
            <p>Access reference tables via the <strong>References</strong> menu.</p>

            <h3 id="customs-config">Customs Config (Section 232 Tariffs)</h3>
            <p>This table contains the HTS codes subject to Section 232 tariffs and their classifications.</p>

            <table>
                <tr>
                    <th>Column</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>HTS Code</td>
                    <td>8 or 10 digit HTS code</td>
                </tr>
                <tr>
                    <td>Material</td>
                    <td>Steel, Aluminum, Copper, Wood, or Automotive</td>
                </tr>
                <tr>
                    <td>Classification</td>
                    <td>Product classification</td>
                </tr>
                <tr>
                    <td>Chapter</td>
                    <td>HTS chapter number</td>
                </tr>
                <tr>
                    <td>Declaration Required</td>
                    <td>Declaration code (e.g., "08 - Steel")</td>
                </tr>
            </table>

            <h4>Importing Tariff Data</h4>
            <p>Click <strong>Import CSV</strong> to update the tariff table from a CSV file with the following columns:</p>
            <div class="code-block">hts_code,material,classification,chapter,chapter_description,declaration_required,notes</div>

            <h3 id="sec232-actions">Section 232 Actions</h3>
            <p>This table tracks Section 232 proclamations, exclusions, and rate changes.</p>

            <table>
                <tr>
                    <th>Column</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>Tariff No</td>
                    <td>HTS tariff number</td>
                </tr>
                <tr>
                    <td>Action</td>
                    <td>Type of action (exclusion, rate change, etc.)</td>
                </tr>
                <tr>
                    <td>Ad Valorem Rate</td>
                    <td>Percentage rate</td>
                </tr>
                <tr>
                    <td>Effective Date</td>
                    <td>When the action takes effect</td>
                </tr>
                <tr>
                    <td>Expiration Date</td>
                    <td>When the action expires</td>
                </tr>
            </table>
        </div>

        <!-- Section 7: Parts View -->
        <div class="section" id="parts-view">
            <h2>7. Parts View</h2>
            <p>The Parts View tab provides a searchable, editable view of your Parts Master database.</p>

            <h3>Features</h3>
            <ul>
                <li><strong>Search</strong> - Filter parts by part number, description, or HTS code</li>
                <li><strong>Sort</strong> - Click column headers to sort</li>
                <li><strong>Edit</strong> - Double-click cells to edit values</li>
                <li><strong>Save</strong> - Click "Save Changes" to persist edits to the database</li>
                <li><strong>Refresh</strong> - Reload data from the database</li>
            </ul>

            <h3>Columns</h3>
            <table>
                <tr>
                    <th>Column</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>Part Number</td>
                    <td>Unique part identifier</td>
                </tr>
                <tr>
                    <td>Description</td>
                    <td>Product description</td>
                </tr>
                <tr>
                    <td>HTS Code</td>
                    <td>10-digit HTS code</td>
                </tr>
                <tr>
                    <td>Country</td>
                    <td>Country of origin (2-letter code)</td>
                </tr>
                <tr>
                    <td>MID</td>
                    <td>Manufacturer ID</td>
                </tr>
                <tr>
                    <td>Steel%</td>
                    <td>Section 232 Steel ratio (0-100%)</td>
                </tr>
                <tr>
                    <td>Al%</td>
                    <td>Section 232 Aluminum ratio</td>
                </tr>
                <tr>
                    <td>Cu%</td>
                    <td>Section 232 Copper ratio</td>
                </tr>
                <tr>
                    <td>Wood%</td>
                    <td>Section 232 Wood ratio</td>
                </tr>
                <tr>
                    <td>Auto%</td>
                    <td>Section 232 Automotive ratio</td>
                </tr>
                <tr>
                    <td>Melt/Cast/Smelt</td>
                    <td>Countries for smelting declarations</td>
                </tr>
                <tr>
                    <td>Sec301</td>
                    <td>Section 301 exclusion tariff code</td>
                </tr>
            </table>

            <h3>Import HTS Units</h3>
            <p>Click "Import HTS Units" to load CBP quantity unit definitions from an Excel file. This updates the CBP_qty1 field for matching HTS codes.</p>
        </div>

        <!-- Section 8: Settings -->
        <div class="section" id="settings">
            <h2>8. Application Settings</h2>
            <p>Access settings via <strong>Settings > Settings</strong> from the menu bar.</p>

            <h3>General Settings</h3>
            <table>
                <tr>
                    <th>Setting</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>Input Directory</td>
                    <td>Folder where invoice files are placed for processing</td>
                </tr>
                <tr>
                    <td>Output Directory</td>
                    <td>Folder where export files are saved</td>
                </tr>
                <tr>
                    <td>Database Path</td>
                    <td>Location of the SQLite database (can be network path)</td>
                </tr>
                <tr>
                    <td>Default File Viewer</td>
                    <td>Application to open exported files (System Default or Microsoft Excel)</td>
                </tr>
            </table>

            <h3>Appearance</h3>
            <table>
                <tr>
                    <th>Setting</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>Theme</td>
                    <td>Fusion (Light), Fusion (Dark), Ocean, or Windows Native</td>
                </tr>
                <tr>
                    <td>Font Size</td>
                    <td>Adjust application font size (8pt - 14pt)</td>
                </tr>
            </table>

            <h3>Preview Table Row Colors</h3>
            <p>Customize the colors used to indicate different Section 232 material types in the preview table:</p>
            <ul>
                <li><span class="color-sample" style="background: #4a4a4a;"></span><strong>Steel</strong> - Default: Dark Gray</li>
                <li><span class="color-sample" style="background: #3498db;"></span><strong>Aluminum</strong> - Default: Blue</li>
                <li><span class="color-sample" style="background: #e67e22;"></span><strong>Copper</strong> - Default: Orange</li>
                <li><span class="color-sample" style="background: #27ae60;"></span><strong>Wood</strong> - Default: Green</li>
                <li><span class="color-sample" style="background: #9b59b6;"></span><strong>Auto</strong> - Default: Purple</li>
                <li><span class="color-sample" style="background: #ff0000;"></span><strong>Non-232</strong> - Default: Red</li>
                <li><span class="color-sample" style="background: #ffc8c8;"></span><strong>Sec301 Background</strong> - Default: Light Pink</li>
            </ul>

            <h3>Export File Font Colors</h3>
            <p>Customize the font colors used in exported Excel files for each material type.</p>

            <h3>Updates</h3>
            <ul>
                <li><strong>Check for updates on startup</strong> - Automatically check GitHub for new versions</li>
                <li><strong>Check for Updates</strong> - Manually check for updates via Help menu</li>
            </ul>
        </div>

        <!-- Section 9: Troubleshooting -->
        <div class="section" id="troubleshooting">
            <h2>9. Troubleshooting</h2>

            <h3>Common Issues</h3>

            <div class="feature-card">
                <h4>File Not Loading</h4>
                <ul>
                    <li>Ensure the file is in CSV or Excel format (.csv, .xlsx, .xls)</li>
                    <li>Check that the correct mapping profile is selected</li>
                    <li>Verify the header row setting matches your file</li>
                    <li>Check the Log View for detailed error messages</li>
                </ul>
            </div>

            <div class="feature-card">
                <h4>Values Don't Match</h4>
                <ul>
                    <li>Verify the CI Value matches the invoice total</li>
                    <li>Check for missing or zero-value line items</li>
                    <li>Use Edit Values mode to identify discrepancies</li>
                    <li>Check if quantity multipliers are applied correctly</li>
                </ul>
            </div>

            <div class="feature-card">
                <h4>Parts Not Found</h4>
                <ul>
                    <li>Check if the part number exists in Parts View</li>
                    <li>Verify part number format matches (case sensitivity)</li>
                    <li>Use Parts Import to add missing parts</li>
                    <li>Check the invoice mapping for the Part Number field</li>
                </ul>
            </div>

            <div class="feature-card">
                <h4>Export Errors</h4>
                <ul>
                    <li>Ensure the Output Directory is writable</li>
                    <li>Check if another program has the file open</li>
                    <li>For network paths, verify connectivity</li>
                    <li>Check available disk space</li>
                </ul>
            </div>

            <div class="feature-card">
                <h4>Database Connection Issues</h4>
                <ul>
                    <li>Verify the database file exists at the configured path</li>
                    <li>For network databases, check network connectivity</li>
                    <li>Ensure you have read/write permissions</li>
                    <li>Check if the database is locked by another user</li>
                </ul>
            </div>

            <h3>Viewing the Log</h3>
            <p>The application log contains detailed information about operations and errors:</p>
            <ol>
                <li>Go to <strong>Log View > View Log</strong></li>
                <li>Review recent entries for error messages</li>
                <li>Use "Copy to Clipboard" to share logs for support</li>
            </ol>
        </div>

        <!-- Section 10: Keyboard Shortcuts -->
        <div class="section" id="keyboard">
            <h2>10. Keyboard Shortcuts</h2>

            <table>
                <tr>
                    <th>Shortcut</th>
                    <th>Action</th>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Tab</span></td>
                    <td>Move to next control</td>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Shift+Tab</span></td>
                    <td>Move to previous control</td>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Enter</span></td>
                    <td>Activate focused button / Open selected file</td>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Double-Click</span></td>
                    <td>Edit cell in preview table / Open exported file</td>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Ctrl+C</span></td>
                    <td>Copy selected cells</td>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Ctrl+V</span></td>
                    <td>Paste into selected cells</td>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Delete</span></td>
                    <td>Clear selected cells</td>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Esc</span></td>
                    <td>Cancel current operation / Close dialog</td>
                </tr>
            </table>

            <h3>Preview Table Navigation</h3>
            <table>
                <tr>
                    <th>Shortcut</th>
                    <th>Action</th>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Arrow Keys</span></td>
                    <td>Navigate between cells</td>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Page Up/Down</span></td>
                    <td>Scroll through rows</td>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Home</span></td>
                    <td>Go to first column</td>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">End</span></td>
                    <td>Go to last column</td>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Ctrl+Home</span></td>
                    <td>Go to first cell</td>
                </tr>
                <tr>
                    <td><span class="keyboard-shortcut">Ctrl+End</span></td>
                    <td>Go to last cell</td>
                </tr>
            </table>
        </div>

        <!-- Footer -->
        <div class="section" style="text-align: center; background: #f0f0f0;">
            <p style="color: #666;">Derivative Mill - Customs Documentation Processing System</p>
            <p style="color: #999; font-size: 0.9em;">For support, visit the GitHub repository or contact your system administrator.</p>
        </div>
    </div>

    <a href="#top" class="back-to-top" title="Back to Top">^</a>
</body>
</html>
